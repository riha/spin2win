var ViewModels;(function(n){(function(n){var t=function(){function t(t,i){this.players=t,this.settings=i;var r=this;this.players=ko.observableArray([]),this.editedPlayer=ko.observable(),$.each(t,function(t,i){console.log(i,r.players()),r.players.push(new n.EditablePlayer(i))}),this.players.sort(this.sortAlphabetically),this.includePlayer=this.includePlayer.bind(this),this.saveSetting=this.saveSetting.bind(this),this.addPlayer=this.addPlayer.bind(this),this.editPlayer=this.editPlayer.bind(this),this.savePlayer=this.savePlayer.bind(this),this.deletePlayer=this.deletePlayer.bind(this),this.isEdited=ko.computed(function(){return r.editedPlayer()!=undefined}),this.settings==null&&(this.settings=Models.Settings.defaultObject()),this.isPlayable=ko.computed(function(){for(var t=0,n=0;n<r.players().length;n++)console.log(r.players()[n],r.players()[n].included()),r.players()[n].included()&&(console.log("yes"),t++);return t>1})}return t.prototype.navigatePlay=function(){this.isPlayable()&&(console.log("Va fan"),location.href="/Play/Index")},t.prototype.saveSetting=function(n){$.ajax("/Admin/SaveSettings",{data:ko.toJSON({settings:n.settings}),type:"post",contentType:"application/json",dataType:"json"})},t.prototype.addPlayer=function(){this.editedPlayer(new n.EditablePlayer(Models.Player.defaultObject()))},t.prototype.totalNumberOfSlots=function(){var n=0;return $.each(this.players(),function(t,i){n=n+Number(i.numberOfSlots())}),n},t.prototype.includePlayer=function(n){n.included()?n.included(!1):n.included(!0),this.persistPlayer(n,function(){},"/Admin/SavePlayer")},t.prototype.editPlayer=function(n){this.editedPlayer(n)},t.prototype.deletePlayer=function(){var n=this,t=function(){for(var t=0;t<n.players().length;t++)if(n.editedPlayer().id==n.players()[t].id){n.players.splice(t,1);break}n.editedPlayer(undefined)};this.persistPlayer(this.editedPlayer(),t,"/Admin/DeletePlayer")},t.prototype.savePlayer=function(){var n=this,t=function(t){if(n.editedPlayer().isNew())n.editedPlayer().id=t.Id,n.players.push(n.editedPlayer());else for(var i=0;i<n.players().length;i++)if(n.editedPlayer().id==n.players()[i].id){n.players.splice(i,1,n.editedPlayer());break}n.players.sort(n.sortAlphabetically),n.editedPlayer(undefined)};this.persistPlayer(this.editedPlayer(),t,"/Admin/SavePlayer")},t.prototype.persistPlayer=function(n,t,i){$.ajax(i,{data:ko.toJSON(n),type:"post",contentType:"application/json",dataType:"json"}).done(t)},t.prototype.sortAlphabetically=function(n,t){return n.name()<t.name()?-1:n.name()>t.name()?1:0},t}();n.ViewModel=t})(n.Admin||(n.Admin={}));var t=n.Admin})(ViewModels||(ViewModels={}))