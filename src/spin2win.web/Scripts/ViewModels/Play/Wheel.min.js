var Models;(function(n){var t=function(){function n(n,t){this.canvas=n,this.canvasBg=t,this.outsideRadius=200,this.insideRadius=20,this.spinTime=0,this.startAngle=0,this.lastDegree=0,this.slots=[],this.centerX=this.canvas.width/2,this.centerY=this.canvas.height/2,this.context=n.getContext("2d"),this.contextBg=t.getContext("2d"),this.spin=this.spin.bind(this),this.rotateWheel=this.rotateWheel.bind(this),this.stopRotateWheel=this.stopRotateWheel.bind(this)}return n.prototype.clear=function(){this.slots=[],this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.restore(),this.contextBg.save(),this.contextBg.setTransform(1,0,0,1,0,0),this.contextBg.clearRect(0,0,this.canvasBg.width,this.canvasBg.height),this.contextBg.restore()},n.prototype.draw=function(n){var r,u,e,t,f,i;for(this.shadow(),this.background(),r=0;r<n.length;r++)for(u=n[r],console.log(u),t=0;t<u.numberOfSlots;t++)this.slots.push(u);for(this.contextBg.lineWidth=2,e=0,this.arc=Math.PI/(this.slots.length/2),t=0;t<this.slots.length;t++)f=this.slots[t].color,i=e+t*this.arc,this.context.fillStyle=f,this.context.strokeStyle=Common.Utils.shadeColor(f,20),this.context.beginPath(),this.context.arc(this.centerX,this.centerY,this.outsideRadius,i,i+this.arc,!1),this.context.arc(this.centerX,this.centerY,this.insideRadius,i+this.arc,i,!0),this.context.fill(),this.context.stroke();console.log("klar")},n.prototype.background=function(){this.contextBg.beginPath(),this.contextBg.arc(this.centerX,this.centerY,this.outsideRadius+9,0,2*Math.PI,!1),this.contextBg.fillStyle="#aaa",this.contextBg.fill()},n.prototype.shadow=function(){this.contextBg.beginPath(),this.contextBg.arc(this.centerX-2,this.centerY+3,this.outsideRadius+9,0,2*Math.PI,!1),this.contextBg.fillStyle="rgba(0, 0, 0, 0.7)",this.contextBg.fill()},n.prototype.spin=function(){this.spinTime=0,this.spinTimeTotal=Number(Math.random()*3+18e3),this.spinAngleStart=Math.random()*10+10,this.rotateWheel()},n.prototype.rotateWheel=function(){var t=24,i,n;if(this.spinTime+=t,this.spinTime>=this.spinTimeTotal){this.stopRotateWheel();return}if(i=this.spinAngleStart-Common.Utils.easeOutExpo(this.spinTime,0,this.spinAngleStart,this.spinTimeTotal),this.startAngle=this.startAngle+i*Math.PI/180,n=this.startAngle*180/Math.PI,this.spinTimeoutId=setTimeout(this.rotateWheel,t),this.lastDegree.toFixed(2)==n.toFixed(2)){this.stopRotateWheel();return}this.lastDegree=n,this.setCurrentSlotIndex(),$(document).trigger("move",n)},n.prototype.setCurrentSlotIndex=function(){var t=this.startAngle*180/Math.PI+90,i=this.arc*180/Math.PI,n=Math.floor((360-t%360)/i);n!=this.currentSlotIndex&&(this.currentSlotIndex=n),$(document).trigger("current",this.slots[this.currentSlotIndex])},n.prototype.stopRotateWheel=function(){clearTimeout(this.spinTimeoutId),$(document).trigger("complete",this.slots[this.currentSlotIndex])},n}();n.Wheel=t})(Models||(Models={}))